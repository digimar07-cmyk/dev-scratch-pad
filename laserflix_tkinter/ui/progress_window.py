"""\nUI — Progress Window\nJanela de progresso para análises em lote\n"""\n\nimport tkinter as tk\nfrom tkinter import ttk\n\n\nclass ProgressWindow:\n    def __init__(self, parent):\n        self.parent = parent\n        self.window = None\n        self.progress_bar = None\n        self.status_label = None\n\n    def show(self, title="Processando..."):\n        """Exibe janela de progresso."""\n        if self.window:\n            return\n        self.window = tk.Toplevel(self.parent)\n        self.window.title(title)\n        self.window.geometry("500x150")\n        self.window.configure(bg="#1A1A1A")\n        self.window.resizable(False, False)\n        self.window.transient(self.parent)\n        self.window.grab_set()\n\n        # Label de status\n        self.status_label = tk.Label(self.window, text="Iniciando...",\n                                    font=("Arial", 10), bg="#1A1A1A", fg="#FFFFFF")\n        self.status_label.pack(pady=20)\n\n        # Progress bar\n        self.progress_bar = ttk.Progressbar(self.window, mode="determinate", length=400)\n        self.progress_bar.pack(pady=10)\n\n        # Botão cancelar\n        cancel_btn = tk.Button(self.window, text="⏹ Cancelar", bg="#E50914", fg="white",\n                              font=("Arial", 10, "bold"), relief="flat",\n                              command=self._on_cancel)\n        cancel_btn.pack(pady=10)\n\n        self.cancel_callback = None\n\n    def update(self, current, total, message=""):\n        """Atualiza progresso."""\n        if not self.window:\n            return\n        if total > 0:\n            percent = (current / total) * 100\n            self.progress_bar['value'] = percent\n        if message:\n            self.status_label.config(text=f"{current}/{total} - {message}")\n        self.window.update_idletasks()\n\n    def hide(self):\n        """Fecha janela de progresso."""\n        if self.window:\n            self.window.grab_release()\n            self.window.destroy()\n            self.window = None\n\n    def set_cancel_callback(self, callback):\n        """Define callback de cancelamento."""\n        self.cancel_callback = callback\n\n    def _on_cancel(self):\n        """Callback de botão cancelar."""\n        if self.cancel_callback:\n            self.cancel_callback()\n        self.hide()\n