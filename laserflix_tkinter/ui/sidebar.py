"""\nUI ‚Äî Sidebar\nBarra lateral com filtros e estat√≠sticas\n"""\n\nimport tkinter as tk\nfrom tkinter import ttk\nfrom collections import Counter\n\n\nclass Sidebar:\n    def __init__(self, parent, filters_obj, callbacks):\n        """\n        callbacks: dict com {\n            'filter_change': func(filter_type),\n            'origin_change': func(origin),\n            'category_change': func(categories_list),\n            'tag_change': func(tag),\n            'refresh': func()\n        }\n        """\n        self.parent = parent\n        self.filters = filters_obj\n        self.callbacks = callbacks\n        self.frame = tk.Frame(parent, bg="#1A1A1A", width=250)\n        self.frame.pack(side="left", fill="y")\n        self.frame.pack_propagate(False)\n        self.create_ui()\n\n    def create_ui(self):\n        """Cria interface da sidebar."""\n        # T√≠tulo\n        title = tk.Label(self.frame, text="FILTROS", font=("Arial", 14, "bold"),\n                        bg="#1A1A1A", fg="#FFFFFF")\n        title.pack(pady=10)\n\n        # Filtros principais\n        filters_frame = tk.Frame(self.frame, bg="#1A1A1A")\n        filters_frame.pack(fill="x", padx=10, pady=5)\n        self._create_filter_buttons(filters_frame)\n\n        # Origem\n        self.origin_combo = ttk.Combobox(self.frame, state="readonly")\n        self.origin_combo.pack(fill="x", padx=10, pady=5)\n        self.origin_combo.bind("<<ComboboxSelected>>", self._on_origin_change)\n\n        # Categorias\n        cat_label = tk.Label(self.frame, text="Categorias", font=("Arial", 10, "bold"),\n                           bg="#1A1A1A", fg="#FFFFFF")\n        cat_label.pack(pady=(10, 5))\n        self.categories_listbox = tk.Listbox(self.frame, height=8, selectmode="multiple",\n                                           bg="#2A2A2A", fg="#FFFFFF",\n                                           selectbackground="#E50914")\n        self.categories_listbox.pack(fill="x", padx=10)\n        self.categories_listbox.bind("<<ListboxSelect>>", self._on_category_change)\n\n        # Tags\n        tag_label = tk.Label(self.frame, text="Tags", font=("Arial", 10, "bold"),\n                           bg="#1A1A1A", fg="#FFFFFF")\n        tag_label.pack(pady=(10, 5))\n        self.tags_listbox = tk.Listbox(self.frame, height=10, bg="#2A2A2A", fg="#FFFFFF",\n                                      selectbackground="#E50914")\n        self.tags_listbox.pack(fill="both", expand=True, padx=10, pady=(0, 10))\n        self.tags_listbox.bind("<<ListboxSelect>>", self._on_tag_change)\n\n    def _create_filter_buttons(self, parent):\n        """Cria bot√µes de filtro principal."""\n        filters = [\n            ("Todos", "all", "#E50914"),\n            ("‚≠ê Favoritos", "favorite", "#FFD700"),\n            ("‚úì Feitos", "done", "#00FF00"),\n            ("üëç Bons", "good", "#00AA00"),\n            ("üëé Ruins", "bad", "#FF0000"),\n        ]\n        for label, filter_type, color in filters:\n            btn = tk.Button(parent, text=label, bg=color, fg="white",\n                          font=("Arial", 9, "bold"), relief="flat",\n                          command=lambda f=filter_type: self._on_filter_change(f))\n            btn.pack(fill="x", pady=2)\n\n    def _on_filter_change(self, filter_type):\n        """Callback de mudan√ßa de filtro."""\n        if self.callbacks.get('filter_change'):\n            self.callbacks['filter_change'](filter_type)\n\n    def _on_origin_change(self, event):\n        """Callback de mudan√ßa de origem."""\n        origin = self.origin_combo.get()\n        if self.callbacks.get('origin_change'):\n            self.callbacks['origin_change'](origin)\n\n    def _on_category_change(self, event):\n        """Callback de mudan√ßa de categoria."""\n        selection = self.categories_listbox.curselection()\n        categories = [self.categories_listbox.get(i) for i in selection]\n        if self.callbacks.get('category_change'):\n            self.callbacks['category_change'](categories)\n\n    def _on_tag_change(self, event):\n        """Callback de sele√ß√£o de tag."""\n        selection = self.tags_listbox.curselection()\n        if selection:\n            tag = self.tags_listbox.get(selection[0])\n            if self.callbacks.get('tag_change'):\n                self.callbacks['tag_change'](tag)\n\n    def update_data(self, database):\n        """Atualiza dados da sidebar."""\n        # Origens\n        origins = ["Todas"] + sorted(set(d.get("origin", "Diversos") for d in database.values()))\n        self.origin_combo['values'] = origins\n        self.origin_combo.set("Todas")\n\n        # Categorias\n        all_categories = []\n        for data in database.values():\n            all_categories.extend(data.get("categories", []))\n        cat_counter = Counter(all_categories)\n        self.categories_listbox.delete(0, tk.END)\n        for cat, count in cat_counter.most_common(30):\n            self.categories_listbox.insert(tk.END, f"{cat} ({count})")\n\n        # Tags\n        all_tags = []\n        for data in database.values():\n            all_tags.extend(data.get("tags", []))\n        tag_counter = Counter(all_tags)\n        self.tags_listbox.delete(0, tk.END)\n        for tag, count in tag_counter.most_common(50):\n            self.tags_listbox.insert(tk.END, f"{tag} ({count})")\n