"""\nUtils — Image Loader\nCarregamento de imagens (cover, hero, galeria)\n"""\n\nimport os\nfrom PIL import Image, ImageTk\nfrom config import LOGGER\n\n\nclass ImageLoader:\n    @staticmethod\n    def get_cover_image(project_path, cache):\n        """Retorna thumbnail da capa (220x200) com cache LRU."""\n        img_path = ImageLoader._find_first_image_path(project_path)\n        if not img_path:\n            return None\n        try:\n            mtime = os.path.getmtime(img_path)\n        except Exception:\n            return None\n        try:\n            cached = cache.get(img_path)\n            if cached:\n                cached_mtime, cached_photo = cached\n                if cached_mtime == mtime:\n                    cache.move_to_end(img_path)\n                    return cached_photo\n            photo = ImageLoader._load_thumbnail_photo(img_path)\n            cache[img_path] = (mtime, photo)\n            cache.move_to_end(img_path)\n            cache_limit = 300\n            while len(cache) > cache_limit:\n                cache.popitem(last=False)\n            return photo\n        except Exception:\n            LOGGER.exception(f"Erro ao gerar thumbnail de {img_path}")\n            return None\n\n    @staticmethod\n    def _load_thumbnail_photo(img_path):\n        """Carrega e redimensiona thumbnail 220x200."""\n        img = Image.open(img_path)\n        img.thumbnail((220, 200), Image.Resampling.LANCZOS)\n        return ImageTk.PhotoImage(img)\n\n    @staticmethod\n    def _find_first_image_path(project_path):\n        """Retorna caminho da primeira imagem válida."""\n        valid_extensions = (".png", ".jpg", ".jpeg", ".gif", ".bmp", ".webp")\n        try:\n            for item in os.listdir(project_path):\n                if item.lower().endswith(valid_extensions):\n                    return os.path.join(project_path, item)\n        except Exception:\n            LOGGER.exception(f"Falha ao listar {project_path}")\n        return None\n\n    @staticmethod\n    def get_hero_image(project_path, max_width=800):\n        """Retorna imagem hero redimensionada para modal."""\n        try:\n            valid_extensions = (".png", ".jpg", ".jpeg", ".gif", ".bmp")\n            for item in os.listdir(project_path):\n                if item.lower().endswith(valid_extensions):\n                    img_path = os.path.join(project_path, item)\n                    img = Image.open(img_path)\n                    if img.width > max_width:\n                        ratio = max_width / img.width\n                        img = img.resize((max_width, int(img.height * ratio)), Image.Resampling.LANCZOS)\n                    return ImageTk.PhotoImage(img)\n        except Exception:\n            LOGGER.exception(f"Falha ao carregar hero image de {project_path}")\n        return None\n\n    @staticmethod\n    def get_all_project_images(project_path):\n        """Retorna lista de todos os caminhos de imagens do projeto."""\n        valid_extensions = (".png", ".jpg", ".jpeg", ".gif", ".bmp")\n        images = []\n        try:\n            for item in os.listdir(project_path):\n                if item.lower().endswith(valid_extensions):\n                    images.append(os.path.join(project_path, item))\n        except Exception:\n            LOGGER.exception(f"Falha ao listar imagens de {project_path}")\n        return sorted(images)\n